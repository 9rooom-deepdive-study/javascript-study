# 24장 - 클로저
## SUMMARY
- 클로저는 함수와 그 함수가 선언된 렉시컬 환경과의 조합이다. byMDN
- 렉시컬 스코프(정적 스코프): 자바스크립트 엔진은 함수를 어디서 호출했는지가 아니라 **함수를 어디에 정의했는지**에 따라 상위 스코프를 결정한다.
- 함수는 자신의 내부 슬롯 `[[Environment]]`에 자신이 정의된 환경, 즉 상위 스코프의 참조를 저장하여 기억한다.
- 외부 렉시컬 환경에 대한 참조에는 함수 객체의 내부 슬롯 `[[Environment]]`에 저장된 렉시컬 환경의 참조가 할당된다.
- 외부 함수보다 중첩 함수가 더 오래 유지되는 경우 중첩 함수는 이미 생명 주기가 종료한 외부 함수의 변수를 참조할 수 있다. 이러한 중첩 함수를 클로저라고 부른다.

<img alt="" src="https://github.com/user-attachments/assets/0bcf96e2-490a-4c6b-80f8-2319fd086735" />

- 함수 평가 -> 함수 호출 -> 함수 내부 코드 평가 -> 함수 실행
  - 함수 평가 시: 함수 객체 생성, 함수 객체의 `[[Environment]]`에 상위 스코프가 저장된다. 여기서 상위 스코프란 평가 시점에 현재 실행 중인 실행 컨텍스트의 렉시컬 환경이다.
  - 함수 내부 코드 평가 시: 함수 실행 컨텍스트 생성, 외부 렉시컬 환경에 대한 참조에 `[[Environment]]`에 저장되어 있는 참조값이 할당된다.
- outer 함수의 실행이 종료하면, outer 함수의 실행 컨텍스트는 실행 컨텍스트 스택에서 제거되지만 outer 함수의 렉시컬 환경까지 소멸하는 것은 아니다.
  - 누군가 참조하고 있는 한 가비지 컬렉터에 의해 메모리 공간이 해제되지 않는다.
- 클로저는 중첩 함수가 **상위 스코프의 식별자를 참조**하고 있고, 중첩 함수가 **외부 함수보다 더 오래 유지**되는 경우에 한정하는 것이 일반적이다.
